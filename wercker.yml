box: 0xf0/node-phantomjs
build:
  steps:
    - script:
        code: export NODE_ENV=development
    - wercker/install-packages:
        packages: npm
    - npm-install
    - script:
        code: NODE_ENV=production npm run deploy
    - script:
        code: cp -R dist "$WERCKER_OUTPUT_DIR"

deploy:
  steps:
    - ematsen/gh-pages:
        token: $GITHUB_TOKEN
        path: dist
        domain: usezen.it

  digitalocean:
    - add-to-known_hosts:
        hostname: usezen.it
    - mktemp:
        envvar: PRIVATEKEY_PATH
    - create-file:
        name: write key
        filename: $PRIVATEKEY_PATH
        content: $SSH_PRIVATE
        overwrite: true
    - script:
        name: transfer application
        code: |
          pwd
          ls -la
          scp -R -i $PRIVATEKEY_PATH dist wercker@usezen.it:/var/www/usezen.it
